<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS Architecture & Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f4f7f6; color: #1a1a1a; }
        .architect-title { font-family: 'Playfair Display', serif; }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(0,0,0,0.05); }
        .sidebar { background: #1a202c; color: #e2e8f0; }
        .stat-card { border-top: 4px solid #2d3748; transition: transform 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="w-64 sidebar hidden md:flex flex-col p-6 shadow-xl">
        <h2 class="architect-title text-2xl mb-10 text-white">CS Opus 1.0</h2>
        <nav class="space-y-4 flex-1">
            <a href="#" class="block p-3 rounded bg-gray-800 text-white">Dashboard</a>
            <a href="#" class="block p-3 rounded hover:bg-gray-700">Ekip Analizi</a>
            <a href="#" class="block p-3 rounded hover:bg-gray-700">Veri LoglarÄ±</a>
        </nav>
        <div class="text-xs text-gray-500 border-t border-gray-700 pt-4">
            Built with 500 years of Engineering Wisdom
        </div>
    </aside>

    <main class="flex-1 p-8 overflow-y-auto">
        <header class="flex justify-between items-end mb-12">
            <div>
                <h1 class="architect-title text-4xl text-gray-900">Operasyonel Mimari Paneli</h1>
                <p class="text-gray-500 mt-2">Verinin estetiÄŸi, sistemin performansÄ±.</p>
            </div>
            <div class="flex items-center space-x-4">
                <input type="file" id="csvFile" accept=".csv" class="hidden">
                <label for="csvFile" class="cursor-pointer bg-black text-white px-6 py-3 rounded-full hover:bg-gray-800 transition shadow-lg">
                    CSV Verisi YÃ¼kle
                </label>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12" id="kpiContainer">
            <div class="glass-card p-6 rounded-xl shadow-sm stat-card">
                <p class="text-sm text-gray-500 uppercase tracking-wider">Toplam Ä°ÅŸlem</p>
                <h3 id="totalHandled" class="text-3xl font-bold mt-2">-</h3>
            </div>
            <div class="glass-card p-6 rounded-xl shadow-sm stat-card">
                <p class="text-sm text-gray-500 uppercase tracking-wider">Ort. YanÄ±t HÄ±zÄ±</p>
                <h3 id="avgResponse" class="text-3xl font-bold mt-2">-</h3>
            </div>
            <div class="glass-card p-6 rounded-xl shadow-sm stat-card text-red-600">
                <p class="text-sm text-gray-400 uppercase tracking-wider">Sistem KaybÄ±</p>
                <h3 id="lostCalls" class="text-3xl font-bold mt-2">-</h3>
            </div>
            <div class="glass-card p-6 rounded-xl shadow-sm stat-card text-green-600">
                <p class="text-sm text-gray-400 uppercase tracking-wider">Ã‡Ã¶zÃ¼m OranÄ±</p>
                <h3 id="resRate" class="text-3xl font-bold mt-2">-</h3>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="glass-card p-8 rounded-2xl shadow-sm">
                <h4 class="text-lg font-semibold mb-6">Temsilci Ä°ÅŸlem Hacmi (AltÄ±n Oran DaÄŸÄ±lÄ±mÄ±)</h4>
                <canvas id="barChart"></canvas>
            </div>
            <div class="glass-card p-8 rounded-2xl shadow-sm">
                <h4 class="text-lg font-semibold mb-6">Zaman Ã‡izelgesi VerimliliÄŸi</h4>
                <canvas id="lineChart"></canvas>
            </div>
        </div>

        <section class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white border border-gray-100 p-8 rounded-2xl shadow-sm">
                <h5 class="flex items-center text-blue-700 font-bold mb-4">
                    <span class="mr-2">ğŸ’»</span> 500 YÄ±llÄ±k YazÄ±lÄ±mcÄ± Notu
                </h5>
                <p id="devNote" class="text-gray-600 italic leading-relaxed">Veri yÃ¼klenmesi bekleniyor. Sistem kernel analizi iÃ§in girdi gerekli...</p>
            </div>
            <div class="bg-white border border-gray-100 p-8 rounded-2xl shadow-sm">
                <h5 class="flex items-center text-amber-700 font-bold mb-4">
                    <span class="mr-2">ğŸ›ï¸</span> 500 YÄ±llÄ±k Mimar Notu
                </h5>
                <p id="archNote" class="text-gray-600 italic leading-relaxed">BinanÄ±n statik raporu iÃ§in zemin verileri (CSV) iÅŸlenmeli...</p>
            </div>
        </section>
    </main>

    <script>
        let barChart, lineChart;

        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            Papa.parse(file, {
                header: true,
                dynamicTyping: true,
                complete: function(results) {
                    processData(results.data);
                }
            });
        });

        function processData(data) {
            // Temizleme (BoÅŸ satÄ±rlarÄ± filtrele)
            const cleanData = data.filter(d => d.å®¢æœæ˜µç§°);

            // KPI HesaplamalarÄ±
            const totalHandled = cleanData.reduce((acc, curr) => acc + (curr.å®¢æœå¤„ç†é‡ || 0), 0);
            const avgResponse = cleanData.reduce((acc, curr) => acc + (curr.å®¢æœå¹³å‡å“åº”æ—¶é•¿ || 0), 0) / cleanData.length;
            const lostCalls = cleanData.reduce((acc, curr) => acc + (curr.è‡ªåŠ¨å…³é—­é‡ || 0), 0);
            
            // UI GÃ¼ncelleme
            document.getElementById('totalHandled').innerText = totalHandled.toLocaleString();
            document.getElementById('avgResponse').innerText = Math.round(avgResponse) + " sn";
            document.getElementById('lostCalls').innerText = lostCalls;
            document.getElementById('resRate').innerText = "%" + (totalHandled > 0 ? ((totalHandled - lostCalls) / totalHandled * 100).toFixed(1) : 0);

            // Grafik Verileri HazÄ±rlama
            const csNames = [...new Set(cleanData.map(d => d.å®¢æœæ˜µç§°))];
            const csVolumes = csNames.map(name => {
                return cleanData.filter(d => d.å®¢æœæ˜µç§° === name).reduce((acc, curr) => acc + (curr.å®¢æœå¤„ç†é‡ || 0), 0);
            });

            updateCharts(csNames, csVolumes);
            updateInsights(totalHandled, avgResponse, lostCalls);
        }

        function updateCharts(labels, values) {
            const ctxBar = document.getElementById('barChart').getContext('2d');
            if(barChart) barChart.destroy();
            barChart = new Chart(ctxBar, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Ä°ÅŸlem SayÄ±sÄ±',
                        data: values,
                        backgroundColor: '#1a202c',
                        borderRadius: 10
                    }]
                }
            });

            // Basit bir tarih trendi iÃ§in veriyi simÃ¼le et (veya tarihe gÃ¶re grupla)
            const ctxLine = document.getElementById('lineChart').getContext('2d');
            if(lineChart) lineChart.destroy();
            lineChart = new Chart(ctxLine, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Verimlilik Skoru',
                        data: values.map(v => v * 0.8),
                        borderColor: '#2d3748',
                        tension: 0.4,
                        fill: true,
                        backgroundColor: 'rgba(45, 55, 72, 0.1)'
                    }]
                }
            });
        }

        function updateInsights(total, avg, lost) {
            document.getElementById('devNote').innerText = `Sistem Log Analizi: Toplam ${total} request iÅŸlendi. YanÄ±t latency (gecikme) ortalamasÄ± ${Math.round(avg)}ms. Garbage Collector (kayÄ±p Ã§aÄŸrÄ±lar) oranÄ± %${(lost/total*100).toFixed(1)}. Stack overflow riski dÃ¼ÅŸÃ¼k, ancak thread senkronizasyonu (ekip daÄŸÄ±lÄ±mÄ±) optimize edilmeli.`;
            document.getElementById('archNote').innerText = `Mimari Rapor: Bu veri yapÄ±sÄ±, temelinde gÃ¼Ã§lÃ¼ bir hacim taÅŸÄ±yor ancak Ã§Ã¶zÃ¼m oranlarÄ±ndaki Ã§atlaklar yapÄ±nÄ±n sÃ¼rdÃ¼rÃ¼lebilirliÄŸini tehdit ediyor. Otomatik kapanan ${lost} kapÄ±, binanÄ±n yalÄ±tÄ±m sorunudur. Estetik ve fonksiyonel denge iÃ§in 'Ã§Ã¶zÃ¼m odaklÄ±' kolonlar gÃ¼Ã§lendirilmeli.`;
        }
    </script>
</body>
</html>