<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hive | CS Analytics (TR/CN)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Noto+Sans+SC:wght@400;700&family=Syne:wght@800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --honey-yellow: #FFD700;
            --deep-black: #0F0F0F;
        }
        body { 
            font-family: 'Space Grotesk', 'Noto Sans SC', sans-serif; 
            background-color: var(--deep-black); 
            color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%231a1a1a' fill-opacity='0.4' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9l10.99-6.35L25 17.9v12.7L13.99 36.95 3 30.6V17.9z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .bee-title { font-family: 'Syne', sans-serif; text-transform: uppercase; }
        .glass-card { 
            background: rgba(26, 26, 26, 0.9); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 215, 0, 0.1); 
            border-radius: 4px; /* Mimari sert hatlar */
            transition: all 0.3s ease;
        }
        .glass-card:hover { border-color: var(--honey-yellow); }
        .stat-value { color: var(--honey-yellow); font-weight: 800; }
        .btn-bee {
            background-color: var(--honey-yellow);
            color: black;
            font-weight: 800;
            transition: all 0.3s ease;
        }
        .btn-bee:hover { background-color: white; box-shadow: 0 0 20px var(--honey-yellow); }
        .lang-switch { font-size: 0.7rem; letter-spacing: 2px; color: #666; }
    </style>
</head>
<body class="p-6 md:p-12">

    <div class="max-w-6xl mx-auto">
        <header class="flex flex-col md:flex-row justify-between items-start mb-16">
            <div>
                <div class="flex space-x-4 mb-4 lang-switch uppercase font-bold">
                    <span class="text-yellow-500">TR / TÃ¼rkÃ§e</span>
                    <span>CN / ä¸­æ–‡</span>
                </div>
                <h1 class="bee-title text-5xl md:text-7xl leading-none">THE <span class="text-yellow-400">HIVE</span></h1>
                <h2 class="text-xl md:text-2xl font-light text-gray-500 mt-2 uppercase tracking-tighter">èœ‚å·¢åˆ†æç³»ç»Ÿ / Kovan Analitik Sistemi</h2>
            </div>
            
            <div class="mt-8 md:mt-0">
                <input type="file" id="fileInput" accept=".csv, .xlsx, .xls" class="hidden">
                <label for="fileInput" class="btn-bee cursor-pointer px-8 py-4 flex flex-col items-center">
                    <span class="text-sm">VERÄ° YÃœKLE / ä¸Šä¼ æ•°æ®</span>
                    <span class="text-[10px] opacity-70">XLSX, CSV</span>
                </label>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-12">
            <div class="glass-card p-6 border-l-4 border-yellow-500">
                <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">Hacim / å¤„ç†é‡</p>
                <h3 id="totalHandled" class="stat-value text-4xl mt-2">0</h3>
            </div>
            <div class="glass-card p-6 border-l-4 border-yellow-500">
                <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">HÄ±z / å“åº”é€Ÿåº¦</p>
                <h3 id="avgRes" class="stat-value text-4xl mt-2">0<span class="text-lg">s</span></h3>
            </div>
            <div class="glass-card p-6 border-l-4 border-white">
                <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">KayÄ±p / è‡ªåŠ¨å…³é—­</p>
                <h3 id="lost" class="stat-value text-4xl mt-2 text-white">0</h3>
            </div>
            <div class="glass-card p-6 border-l-4 border-yellow-500">
                <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">BaÅŸarÄ± / è§£å†³ç‡</p>
                <h3 id="rate" class="stat-value text-4xl mt-2">%0</h3>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12">
            <div class="lg:col-span-2 glass-card p-8">
                <h4 class="text-sm font-bold mb-8 uppercase tracking-widest text-yellow-500">Team Architecture / å›¢é˜Ÿæ¶æ„</h4>
                <div class="h-[300px]">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>

            <div class="flex flex-col gap-4">
                <div class="glass-card p-6">
                    <h5 class="text-xs font-bold text-blue-400 mb-3 uppercase">ğŸ’» Dev Log / å¼€å‘æ—¥å¿—</h5>
                    <p id="devNote" class="text-xs text-gray-400 font-mono leading-relaxed">
                        Sistem beklemede... / ç³»ç»Ÿå°±ç»ªï¼Œç­‰å¾…æ•°æ®...
                    </p>
                </div>
                <div class="glass-card p-6 border-t-2 border-yellow-900">
                    <h5 class="text-xs font-bold text-yellow-600 mb-3 uppercase">ğŸ›ï¸ Architect / å»ºç­‘å¸ˆ</h5>
                    <p id="archNote" class="text-xs text-gray-400 leading-relaxed italic">
                        YapÄ±sal analiz iÃ§in veri bekleniyor. / ç­‰å¾…æ•°æ®è¿›è¡Œç»“æ„åˆ†æã€‚
                    </p>
                </div>
            </div>
        </div>

        <footer class="text-center text-gray-800 text-[9px] uppercase tracking-[1em] py-8 border-t border-yellow-900/20">
            Hive Performance Logic &bull; èœ‚å·¢é€»è¾‘
        </footer>
    </div>

    <script>
        let chartInstance;

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            if (file.name.endsWith('.csv')) {
                Papa.parse(file, {
                    header: true,
                    dynamicTyping: true,
                    complete: function(r) { process(r.data); }
                });
            } else {
                const reader = new FileReader();
                reader.onload = (evt) => {
                    const data = new Uint8Array(evt.target.result);
                    const wb = XLSX.read(data, {type: 'array'});
                    const json = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
                    process(json);
                };
                reader.readAsArrayBuffer(file);
            }
        });

        function process(rawData) {
            const data = rawData.filter(d => d.å®¢æœæ˜µç§°);
            const stats = {
                total: data.reduce((a, b) => a + (Number(b.å®¢æœå¤„ç†é‡) || 0), 0),
                res: data.reduce((a, b) => a + (Number(b.å®¢æœå¹³å‡å“åº”æ—¶é•¿) || 0), 0) / data.length,
                lost: data.reduce((a, b) => a + (Number(b.è‡ªåŠ¨å…³é—­é‡) || 0), 0),
                map: {}
            };

            data.forEach(d => {
                stats.map[d.å®¢æœæ˜µç§°] = (stats.map[d.å®¢æœæ˜µç§°] || 0) + (Number(d.å®¢æœå¤„ç†é‡) || 0);
            });

            // UI Update
            document.getElementById('totalHandled').innerText = stats.total.toLocaleString();
            document.getElementById('avgRes').innerHTML = `${Math.round(stats.res)}<span class="text-lg">s</span>`;
            document.getElementById('lost').innerText = stats.lost.toLocaleString();
            document.getElementById('rate').innerText = `%${(stats.total > 0 ? ((stats.total - stats.lost) / stats.total * 100).toFixed(1) : 0)}`;

            updateChart(stats.map);
            updateInsights(stats);
        }

        function updateChart(map) {
            const ctx = document.getElementById('mainChart').getContext('2d');
            if(chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(map),
                    datasets: [{
                        label: 'Hacim / é‡',
                        data: Object.values(map),
                        backgroundColor: '#FFD700',
                        barThickness: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: '#1a1a1a' }, ticks: { color: '#444' } },
                        x: { grid: { display: false }, ticks: { color: '#FFD700' } }
                    }
                }
            });
        }

        function updateInsights(s) {
            const loss = (s.lost/s.total*100).toFixed(1);
            document.getElementById('devNote').innerText = `[LOG] ${s.total} processed. Loss: %${loss}. 
            ç³»ç»Ÿä¸­å¤„ç†äº† ${s.total} æ¡æ•°æ®ã€‚æ•°æ®ä¸¢å¤±ç‡: %${loss}ã€‚`;
            
            document.getElementById('archNote').innerText = `Mimari: %${loss} kayÄ±p oranÄ±, kovanÄ±n yalÄ±tÄ±m problemidir. 
            å»ºç­‘åˆ†æ: %${loss} çš„è‡ªåŠ¨å…³é—­ç‡è¡¨æ˜èœ‚å·¢çš„å¯†å°æ€§å­˜åœ¨é—®é¢˜ã€‚`;
        }
    </script>
</body>
</html>
